{"config":{"separator":"[\\s\\-_,:!=\\[\\]()\\\\\"`/]+|\\.(?!\\d)"},"items":[{"location":"","level":1,"title":"ruby-prof","text":"<p>ruby-prof is a tracing profiler for MRI Ruby with a long history that dates back to 2005! Its features include:</p> <ul> <li>Measurement Modes - ruby-prof can measure program wall time, process time and object allocations.</li> <li>Reports - ruby-prof can generate flat, graph (text), graph (HTML), flame graph, call stack, graphviz, cachegrind, and call info reports.</li> <li>Threads - supports profiling multiple threads simultaneously.</li> <li>Fibers - supports profiling multiple fibers simultaneously.</li> <li>Merging - supports merging results across fibers or threads</li> <li>Recursive - supports profiling recursive methods</li> </ul> <p></p>","path":["ruby-prof"],"tags":[]},{"location":"#why-ruby-prof","level":2,"title":"Why ruby-prof?","text":"<p>ruby-prof is helpful if your program is slow and you want to know why! It can help you track down methods that are either slow or allocate a large number of objects. Often times the results will surprise you - when profiling what you think you know almost always turns out to be wrong.</p>","path":["ruby-prof"],"tags":[]},{"location":"#installation","level":2,"title":"Installation","text":"<p>To install ruby-prof:</p> <pre><code>gem install ruby-prof\n</code></pre> <p>If you are running Linux or Unix you'll need to have a C compiler installed so the extension can be built when it is installed. If you are running Windows, then you should install the Windows specific gem or install devkit.</p> <p>ruby-prof requires Ruby 3.2.0 or higher. If you need to work with older Ruby versions then you can download an older version of ruby-prof.</p>","path":["ruby-prof"],"tags":[]},{"location":"#performance","level":2,"title":"Performance","text":"<p>ruby-prof is a tracing profiler, not a sampling profiler, and thus will cause your program to run slower. Our tests show that the overhead varies considerably based on the code being profiled. Significant effort has been put into reducing this overhead, but most programs will run approximately twice as slow while highly recursive programs (like the fibonacci series test) may run up to five times slower.</p>","path":["ruby-prof"],"tags":[]},{"location":"#history","level":2,"title":"History","text":"<p>ruby-prof has been under continuous development since 2005 — see the full History page.</p>","path":["ruby-prof"],"tags":[]},{"location":"#api-documentation","level":2,"title":"API Documentation","text":"<p>API documentation for each class is available at the ruby-prof API docs.</p>","path":["ruby-prof"],"tags":[]},{"location":"#license","level":2,"title":"License","text":"<p>See LICENSE for license information.</p>","path":["ruby-prof"],"tags":[]},{"location":"#development","level":2,"title":"Development","text":"<p>Code is located at github.com/ruby-prof/ruby-prof.</p>","path":["ruby-prof"],"tags":[]},{"location":"advanced-usage/","level":1,"title":"Advanced Usage","text":"<p>This section describes advanced usage of ruby-prof. Additional documentation for every class is also available. For workflow guidance, see Best Practices.</p>","path":["Advanced Usage"],"tags":[]},{"location":"advanced-usage/#profiling-options","level":2,"title":"Profiling Options","text":"<p>ruby-prof understands the following options when profiling code:</p> <p>measure_mode - What ruby-prof should measure. For more information see the Measurement Mode section.</p> <p>track_allocations - Tracks each object location, including the object class and source file location. For more information see the Allocation Tracking section.</p> <p>exclude_threads - Array of threads which should not be profiled. For more information see the Thread Inclusion/Exclusion section.</p> <p>include_threads - Array of threads which should be profiled. All other threads will be ignored. For more information see the Thread Inclusion/Exclusion section.</p> <p>allow_exceptions - Whether to raise exceptions encountered during profiling, or to suppress them. Defaults to false.</p> <p>exclude_common - Automatically calls <code>exclude_common_methods!</code> to exclude commonly cluttering methods. Defaults to false. For more information see the Method Exclusion section.</p>","path":["Advanced Usage"],"tags":[]},{"location":"advanced-usage/#measurement-mode","level":2,"title":"Measurement Mode","text":"<p>The measurement mode determines what ruby-prof measures when profiling code. Supported measurements are:</p>","path":["Advanced Usage"],"tags":[]},{"location":"advanced-usage/#wall-time","level":3,"title":"Wall Time","text":"<p>Wall time measures the real-world time elapsed between any two moments in seconds. If there are other processes concurrently running on the system that use significant CPU or disk time during a profiling run then the reported results will be larger than expected. On Windows, wall time is measured using <code>QueryPerformanceCounter</code> and on other platforms by <code>clock_gettime(CLOCK_MONOTONIC)</code>. Use <code>RubyProf::WALL_TIME</code> to select this mode.</p>","path":["Advanced Usage"],"tags":[]},{"location":"advanced-usage/#process-time","level":3,"title":"Process Time","text":"<p>Process time measures the time used by a process between any two moments in seconds. It is unaffected by other processes concurrently running on the system. Remember with process time that calls to methods like sleep will not be included in profiling results. On Windows, process time is measured using <code>GetProcessTimes</code> and on other platforms by <code>clock_gettime</code>. Use <code>RubyProf::PROCESS_TIME</code> to select this mode.</p>","path":["Advanced Usage"],"tags":[]},{"location":"advanced-usage/#object-allocations","level":3,"title":"Object Allocations","text":"<p>Object allocations measures how many objects each method in a program allocates. Measurements are done via Ruby's <code>RUBY_INTERNAL_EVENT_NEWOBJ</code> trace event, counting each new object created (excluding internal <code>T_IMEMO</code> objects). Use <code>RubyProf::ALLOCATIONS</code> to select this mode.</p> <p>To set the measurement mode:</p> <pre><code>profile = RubyProf::Profile.new(measure_mode: RubyProf::WALL_TIME)\nprofile = RubyProf::Profile.new(measure_mode: RubyProf::PROCESS_TIME)\nprofile = RubyProf::Profile.new(measure_mode: RubyProf::ALLOCATIONS)\n</code></pre> <p>The default value is <code>RubyProf::WALL_TIME</code>. You may also specify the measure mode by using the <code>RUBY_PROF_MEASURE_MODE</code> environment variable:</p> <pre><code>export RUBY_PROF_MEASURE_MODE=wall\nexport RUBY_PROF_MEASURE_MODE=process\nexport RUBY_PROF_MEASURE_MODE=allocations\n</code></pre>","path":["Advanced Usage"],"tags":[]},{"location":"advanced-usage/#allocation-tracking","level":2,"title":"Allocation Tracking","text":"<p>ruby-prof also has the ability to track object allocations. This functionality can be turned on via the track_allocations option:</p> <pre><code>require 'ruby-prof'\n\nRubyProf::Profile.profile(track_allocations: true) do\n  ...\nend\n</code></pre> <p>Note the <code>RubyProf::ALLOCATIONS</code> measure mode is slightly different than tracking allocations. The measurement mode provides high level information about the number of allocations performed in each method. In contrast, tracking allocations provides detailed information about allocation type, count, and source location. Currently, to see allocations results you must use the <code>RubyProf::GraphHtmlPrinter</code>.</p>","path":["Advanced Usage"],"tags":[]},{"location":"advanced-usage/#thread-inclusionexclusion","level":2,"title":"Thread Inclusion/Exclusion","text":"<p>ruby-prof can profile multiple threads. Sometimes this can be overwhelming. For example, assume you want to determine why your tests are running slowly. If you are using minitest, it can run tests in parallel by spawning worker threads (to force a single worker, set <code>N=0</code> when running tests). Thus, ruby-prof provides two options to specify which threads should be profiled:</p> <p>exclude_threads - Array of threads which should not be profiled.</p> <p>include_threads - Array of threads which should be profiled. All other threads will be ignored.</p>","path":["Advanced Usage"],"tags":[]},{"location":"advanced-usage/#method-exclusion","level":2,"title":"Method Exclusion","text":"<p>ruby-prof supports excluding specific methods and threads from profiling results. This is useful for reducing connectivity in the call graph, making it easier to identify the source of performance problems when using a graph printer. For example, consider <code>Integer#times</code>: it's hardly ever useful to know how much time is spent in the method itself. We are more interested in how much the passed in block contributes to the time spent in the method which contains the <code>Integer#times</code> call. The effect on collected metrics are identical to eliminating methods from the profiling result in a post process step.</p> <pre><code>profile = RubyProf::Profile.new(...)\nprofile.exclude_methods!(Integer, :times, ...)\nprofile.start\n</code></pre> <p>A convenience method is provided to exclude a large number of methods which usually clutter up profiles:</p> <pre><code>profile.exclude_common_methods!\n</code></pre> <p>However, this is a somewhat opinionated method collection. It's usually better to view it as an inspiration instead of using it directly (see exclude_common_methods.rb).</p>","path":["Advanced Usage"],"tags":[]},{"location":"advanced-usage/#merging-threads-and-fibers","level":2,"title":"Merging Threads and Fibers","text":"<p>ruby-prof profiles each thread and fiber separately. A common design pattern is to have a main thread delegate work to background threads or fibers. Examples include web servers such as Puma and Falcon, as well as code that uses <code>Enumerator</code>, <code>Fiber.new</code>, or async libraries.</p> <p>Understanding profiling results can be very difficult when there are many threads or fibers because each one appears as a separate entry in the output. To help with this, ruby-prof includes the ability to merge results for threads and fibers that start with the same root method. In the best case, this can collapse results into just two entries - one for the parent thread and one for all workers.</p> <p>Note the collapsed results show the sum of times for all merged threads/fibers. For example, assume there are 10 worker fibers that each took 5 seconds to run. The single merged entry will show a total time of 50 seconds.</p> <p>To merge threads and fibers:</p> <pre><code>profile = RubyProf::Profile.profile do\n            ...\n          end\nprofile.merge!\n</code></pre> <p>This is also supported in the Rack adapter via the <code>merge_fibers</code> option:</p> <pre><code>config.middleware.use Rack::RubyProf, path: Rails.root.join(\"tmp/profile\"), merge_fibers: true\n</code></pre>","path":["Advanced Usage"],"tags":[]},{"location":"advanced-usage/#saving-results","level":2,"title":"Saving Results","text":"<p>It can be helpful to save the results of a profiling run for later analysis. Results can be saved using Ruby's marshal library.</p> <pre><code>profile_1 = RubyProf::Profile.profile do\n  ...\nend\n\n# Save the results\ndata = Marshal.dump(profile_1)\n\n# Sometime later load the results\nprofile_2 = Marshal.load(data)\n</code></pre> <p>!!!WARNING!!! - Only load ruby-prof profiles that you know are safe. Demarshaling data can lead to arbitrary code execution and thus can be dangerous.</p>","path":["Advanced Usage"],"tags":[]},{"location":"alternatives/","level":1,"title":"Comparison with Other Profilers","text":"<p>Ruby has several excellent profiling tools, each with different strengths. This page compares ruby-prof with three popular alternatives to help you choose the right tool for your needs.</p>","path":["Comparison with Other Profilers"],"tags":[]},{"location":"alternatives/#tracing-vs-sampling","level":2,"title":"Tracing vs Sampling","text":"<p>The most important distinction between profilers is tracing vs sampling:</p> <ul> <li>Tracing profilers (ruby-prof) instrument every method call and return. This provides exact call counts and complete call graphs, but adds overhead to every method invocation.</li> <li>Sampling profilers (stackprof, rbspy, vernier) periodically capture stack snapshots. This has much lower overhead but may miss short-lived method calls.</li> </ul>","path":["Comparison with Other Profilers"],"tags":[]},{"location":"alternatives/#overview","level":2,"title":"Overview","text":"<p>The table below compares ruby-prof with stackprof, rbspy, and vernier — the three most popular sampling profilers for Ruby.</p> ruby-prof stackprof rbspy vernier Type Tracing Sampling Sampling Sampling Implementation C extension (TracePoint API) C extension (signals) External Rust binary C extension (signals) Code changes None (CLI) or minimal Minimal None Minimal Ruby versions All, since 2006 (currently 3.2+) 2.2+ 1.9.3+ 3.2.1+ OS support Linux, macOS, Windows Linux Linux, macOS, Windows, FreeBSD Linux, macOS","path":["Comparison with Other Profilers"],"tags":[]},{"location":"alternatives/#measurement-capabilities","level":2,"title":"Measurement Capabilities","text":"ruby-prof stackprof rbspy vernier Wall time Yes Yes Yes Yes CPU/Process time Yes Yes No No Allocations Yes Yes No Yes GVL visibility No No No Yes GC pauses No No No Yes Retained memory No No No Yes Multi-thread Yes No No Yes Fibers Yes No No No","path":["Comparison with Other Profilers"],"tags":[]},{"location":"alternatives/#report-formats","level":2,"title":"Report Formats","text":"ruby-prof stackprof rbspy vernier Flat/Summary Yes Yes Yes No Call graph Yes (text + HTML) No No No Flame graph Yes (HTML) Yes Yes (SVG) Yes (Firefox Profiler) Call stack Yes (HTML) No No No Callgrind Yes No Yes No Graphviz dot Yes Yes No No","path":["Comparison with Other Profilers"],"tags":[]},{"location":"alternatives/#when-to-use-each","level":2,"title":"When to Use Each","text":"","path":["Comparison with Other Profilers"],"tags":[]},{"location":"alternatives/#ruby-prof","level":3,"title":"ruby-prof","text":"<p>ruby-prof is the longest-standing Ruby profiler, with its first release in 2005. It has been continuously maintained for nearly two decades, evolving alongside Ruby itself from 1.8 through 4.0. Over that time it has supported every major Ruby version and platform, including Windows — a rarity among Ruby C extensions.</p> <p>Being a tracing profiler, ruby-prof provides exact information about your program. It tracks every thread, every fiber and every method call. It shines with its support for multiple measurements modes and excellent reporting capabilities. </p> <p>ruby-prof can be used from the command line with no code changes, or via an API for more control.</p> <p>The biggest downsides of ruby-prof are:</p> <ul> <li>It adds significant overhead for running programs, so is not suitable for production use</li> <li>It must start a Ruby program, it cannot attach to an already running program</li> </ul>","path":["Comparison with Other Profilers"],"tags":[]},{"location":"alternatives/#stackprof","level":3,"title":"stackprof","text":"<p>stackprof is a low-overhead, sampling profiler that is good for development. It adds minimal overhead while still providing useful flame graphs and per-line hit counts. A good choice when you want something lightweight and well-established.</p> <p>The biggest downsides of stackprof are:</p> <ul> <li>Single-thread only</li> <li>Linux only for time-based modes</li> </ul>","path":["Comparison with Other Profilers"],"tags":[]},{"location":"alternatives/#rbspy","level":3,"title":"rbspy","text":"<p>rbspy is a sampling profiler best for profiling in production or when you cannot modify the application code. As an external process, it attaches to a running Ruby process by PID with zero code changes. It is particularly useful for profiling third-party Ruby applications (Chef, Puppet, etc.), investigating slow test runs, or quick profiling of scripts via <code>rbspy record ruby my-script.rb</code>. Supports the widest range of Ruby versions.</p> <p>The biggest downsides of rbspy are:</p> <ul> <li>No allocation profiling</li> <li>No call graph or caller/callee data</li> </ul>","path":["Comparison with Other Profilers"],"tags":[]},{"location":"alternatives/#vernier","level":3,"title":"vernier","text":"<p>vernier is a sampling profiler best for diagnosing concurrency issues and understanding GVL contention. It is the only Ruby profiler that reports GVL state, GC pauses and idle time. Its Firefox Profiler integration provides rich interactive visualizations with per-thread timelines.</p> <p>The biggest downsides of vernier are:</p> <ul> <li>Requires Ruby 3.2.1+</li> <li>No Windows support</li> </ul>","path":["Comparison with Other Profilers"],"tags":[]},{"location":"alternatives/#rack-mini-profiler","level":3,"title":"rack-mini-profiler","text":"<p>rack-mini-profiler is a \"batteries-included\" profiling tool for Rails and Rack applications. It uses stackprof under the hood for CPU profiling while also supporting memory profiling. It is a good choice if you want an integrated profiling solution that works directly in the browser during development.</p>","path":["Comparison with Other Profilers"],"tags":[]},{"location":"alternatives/#memory-profiling","level":2,"title":"Memory Profiling","text":"<p>memory_profiler is another profiler, but it focuses exclusively on memory usage. It uses Ruby's <code>ObjectSpace</code> API to track every object allocation during a block of code, recording the source file, line number, object type, and size via <code>ObjectSpace.memsize_of</code>. By snapshotting the GC generation before and after, it distinguishes between allocated objects (created during the block) and retained objects (still alive after GC). This makes it useful for finding memory leaks and identifying allocation-heavy code. It's pure Ruby with no C extension, so it works across Ruby versions and platforms.</p> <p>ruby-prof can track allocation counts via its <code>RubyProf::ALLOCATIONS</code> mode, but memory_profiler gives deeper insight into memory specifically — object sizes, retained vs allocated, and per-gem breakdowns.</p>","path":["Comparison with Other Profilers"],"tags":[]},{"location":"architecture/","level":1,"title":"Architecture","text":"","path":["Architecture"],"tags":[]},{"location":"architecture/#overview","level":2,"title":"Overview","text":"<p>ruby-prof is a C extension that uses Ruby's TracePoint API to intercept method calls and returns. Every time a method is entered or exited, ruby-prof records timing and (optionally) allocation data. This tracing approach means ruby-prof captures every method invocation, giving exact call counts and complete call graphs.</p> <p>The diagram below shows the main classes that make up ruby-prof:</p> <pre><code>classDiagram\n    Profile \"1\" *-- \"1\" Measurer\n    Profile \"1\" *-- \"*\" Thread\n    Thread \"1\" *-- \"1\" Stack\n    Thread \"1\" *-- \"*\" MethodInfo\n    Thread \"1\" *-- \"1\" CallTree\n    Stack \"1\" o-- \"*\" Frame\n    Frame --&gt; CallTree\n    CallTree \"1\" *-- \"1\" Measurement\n    CallTree --&gt; MethodInfo : target\n    MethodInfo \"1\" *-- \"1\" CallTrees\n    MethodInfo \"1\" *-- \"1\" Measurement\n    MethodInfo \"1\" *-- \"*\" Allocation\n    CallTrees o-- \"*\" CallTree\n\n    class Profile {\n        +threads: Hash\n        +measurer: Measurer\n    }\n    class Measurer {\n        +mode: MeasurerMode\n        +track_allocations: boolean\n        +multiplier: double\n        +measure: function pointer\n    }\n    class Thread {\n        +methods: Hash\n        +stack: Stack\n        +callTree: CallTree\n    }\n    class Stack {\n        +frames: Array\n    }\n    class Frame {\n        +callTree: CallTree\n    }\n    class CallTree {\n        +parent: CallTree\n        +children: Hash\n        +target: MethodInfo\n        +measurement: Measurement\n    }\n    class MethodInfo {\n        +allocations: Hash\n        +callTrees: CallTrees\n        +measurement: Measurement\n    }\n    class Measurement {\n        +total_time: double\n        +self_time: double\n        +wait_time: double\n        +called: integer\n    }\n    class Allocation {\n        +count: integer\n        +source_file: string\n        +source_line: int\n        +klass: VALUE\n    }\n    class CallTrees {\n        +callTrees: Array\n    }</code></pre>","path":["Architecture"],"tags":[]},{"location":"architecture/#profile","level":2,"title":"Profile","text":"<p>Profile is the top-level object returned by a profiling run:</p> <pre><code>profile = RubyProf::Profile.profile do\n  ...\nend\n</code></pre> <p>A Profile owns a Measurer that determines what is being measured, and a collection of Threads representing each thread (or fiber) that was active during profiling.</p>","path":["Architecture"],"tags":[]},{"location":"architecture/#measurer-and-measurement","level":2,"title":"Measurer and Measurement","text":"<p>The Measurer controls what ruby-prof measures. It holds a function pointer that is called on every method entry and exit to take a measurement. The three modes are:</p> <ul> <li>Wall time — elapsed real time</li> <li>Process time — CPU time consumed by the process (excludes time spent in sleep or I/O)</li> <li>Allocations — number of objects allocated</li> </ul> <p>Each CallTree and MethodInfo holds a Measurement that accumulates the results: total time, self time (excluding children), wait time (time spent waiting on other threads), and call count.</p>","path":["Architecture"],"tags":[]},{"location":"architecture/#thread","level":2,"title":"Thread","text":"<p>Each Thread tracks the methods called on that thread and owns the root of a call tree. It also maintains an internal Stack of Frames used during profiling to track the current call depth.</p> <p>Stack and Frame are transient — they exist only while profiling is active. A Frame records timing data for a single method invocation on the stack, including start time and time spent in child calls. When a method returns, its Frame is popped and the accumulated timing is transferred to the corresponding CallTree node.</p>","path":["Architecture"],"tags":[]},{"location":"architecture/#calltree-and-methodinfo","level":2,"title":"CallTree and MethodInfo","text":"<p>These two classes are central to ruby-prof and represent two different views of the same profiling data:</p> <ul> <li> <p>CallTree records the calling structure — which method called which, forming a graph. Each node has a parent, children, and a reference to its target MethodInfo. A method that is called from two different call sites will have two separate CallTree nodes, each with its own Measurement. Recursive methods create cycles in the graph.</p> </li> <li> <p>MethodInfo represents a single method regardless of where it was called from. It aggregates data across all call sites. Each MethodInfo holds a CallTrees collection that links back to every CallTree node that invoked that method, providing both caller and callee information.</p> </li> </ul> <p>This separation is what allows ruby-prof to generate both call graph reports (which show calling relationships) and flat reports (which show per-method totals).</p>","path":["Architecture"],"tags":[]},{"location":"architecture/#allocation","level":2,"title":"Allocation","text":"<p>When allocation tracking is enabled, each MethodInfo records the objects it allocated. An Allocation tracks the class of object created, the source location, and the count.</p>","path":["Architecture"],"tags":[]},{"location":"architecture/#memory-management","level":2,"title":"Memory Management","text":"<p>The Profile object is responsible for managing the memory of its child objects, which are C structures. When a Profile is garbage collected, it recursively frees all its objects. In the class diagram, composition relationships (filled diamond) indicate ownership — a Profile frees its Threads, Threads free their CallTrees and MethodInfo instances, and so on.</p> <p>ruby-prof keeps a Profile alive as long as there are live references to any of its MethodInfo or CallTree objects. This is done via Ruby's GC mark phase: CallTree instances mark their associated MethodInfo, and MethodInfo instances mark their owning Profile.</p> <p>Starting with version 1.5, it is possible to create Thread, CallTree and MethodInfo instances from Ruby (this was added to support testing). These Ruby-created objects are owned by Ruby's garbage collector rather than the C extension. An internal ownership flag on each instance tracks who is responsible for freeing it.</p>","path":["Architecture"],"tags":[]},{"location":"best-practices/","level":1,"title":"Best Practices","text":"<p>Profiling gives you amazing insight into your program. What you think is slow is almost never what is actually slow. Below are some best practices to help unlock this power.</p>","path":["Best Practices"],"tags":[]},{"location":"best-practices/#start-with-realistic-runs","level":2,"title":"Start With Realistic Runs","text":"<p>When profiling data-heavy work, start with a smaller sample of the data instead of the full dataset. Profile a portion first (for example 1% or 10%). It is faster, easier to understand, and often enough to find the main bottleneck. Once you have a likely fix, validate it with a larger and more realistic workload so you know the result still holds in context. Run the same profile more than once and warm up before you measure so one-time startup work does not dominate the report.</p>","path":["Best Practices"],"tags":[]},{"location":"best-practices/#choose-the-right-measurement-mode","level":2,"title":"Choose The Right Measurement Mode","text":"<p>Pick the measurement mode based on the question you are asking. Use <code>WALL_TIME</code> for end-to-end latency, <code>PROCESS_TIME</code> for CPU-focused work, and <code>ALLOCATIONS</code> when object churn is the concern. See Measurement Mode for details.</p>","path":["Best Practices"],"tags":[]},{"location":"best-practices/#reduce-noise-before-deep-analysis","level":2,"title":"Reduce Noise Before Deep Analysis","text":"<p>When framework internals or concurrency noise dominate output, narrow the scope first. Use <code>exclude_common</code> or explicit method exclusions, and use thread filtering (<code>include_threads</code> / <code>exclude_threads</code>) when needed. For highly concurrent workloads, merging worker results (<code>merge!</code> or Rack <code>merge_fibers: true</code>) can make trends much easier to read. See Profiling Options, Method Exclusion, and Merging Threads and Fibers.</p>","path":["Best Practices"],"tags":[]},{"location":"best-practices/#use-reports-in-a-sequence","level":2,"title":"Use Reports In A Sequence","text":"<p>Start with a quick summary, then drill down. In practice, this usually means using <code>FlatPrinter</code> to find hotspots, <code>GraphHtmlPrinter</code> (or <code>GraphPrinter</code>) to understand caller/callee relationships, and <code>FlameGraphPrinter</code> to validate dominant paths visually. See Reports, especially Creating Reports and Report Types.</p>","path":["Best Practices"],"tags":[]},{"location":"best-practices/#use-threshold-filters-early","level":2,"title":"Use Threshold Filters Early","text":"<p>Threshold filters are one of the fastest ways to make a large profile readable. Start with <code>min_percent</code> to hide low-impact methods in most printers. For <code>GraphHtmlPrinter</code>, use <code>min_time</code> when you want to drop methods below an absolute time cutoff. These filters help you focus on the code that actually moves total runtime.</p>","path":["Best Practices"],"tags":[]},{"location":"best-practices/#compare-trends-not-single-snapshots","level":2,"title":"Compare Trends, Not Single Snapshots","text":"<p>Do not optimize based on one run unless the signal is overwhelming. Compare before/after profiles under the same workload, then prioritize repeated hot paths over one-off spikes.</p>","path":["Best Practices"],"tags":[]},{"location":"changelog/","level":1,"title":"Changelog","text":"","path":["Changelog"],"tags":[]},{"location":"changelog/#200-2026-02-13","level":2,"title":"2.0.0 (2026-02-13)","text":"","path":["Changelog"],"tags":[]},{"location":"changelog/#features","level":3,"title":"Features","text":"<ul> <li>Ruby 4.0 support.</li> <li>Add flame graph visualizations with icicle mode toggle</li> <li>Lots of documentation updates!</li> <li>Apply consistent styling across all reports</li> <li>Add <code>Profile#measure_mode_name</code> method for human-friendly measurement mode names (e.g., \"Wall Time\" instead of \"wall_time\")</li> <li>Fix DotPrinter generating self-referencing edges (was using callers instead of callees)</li> <li>Add Graphviz Online viewer link for dot output</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#backwards-incompatible-changes","level":3,"title":"Backwards Incompatible Changes","text":"<ul> <li>Removed <code>RubyProf::MEMORY</code> measurement mode (no longer works on Ruby 4.0+)</li> <li>Rremove compatibility API that was scheduled for removal in 2023</li> <li>Printer options now use keyword arguments instead of an options hash. For example:   <pre><code># Before:\nprinter.print(STDOUT, :min_percent =&gt; 2, :sort_method =&gt; :self_time)\n# After:\nprinter.print(STDOUT, min_percent: 2, sort_method: :self_time)\n</code></pre></li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#172-2025-05-21","level":2,"title":"1.7.2 (2025-05-21)","text":"<ul> <li>Fix compiling on Ubuntu and Arch Linux</li> <li>Update tests for Ruby 3.4</li> <li>Remove tests for Ruby 3.1</li> <li>Update MacOS to use clock_gettime (same as Linux) instead of proprietary mach_absolute_time API</li> <li>Add CMake support</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#171-2024-10-19","level":2,"title":"1.7.1 (2024-10-19)","text":"<ul> <li>Fix crashes when calling merge due to inconsistent method keys (Chris Heald)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#170-2024-01-07","level":2,"title":"1.7.0 (2024-01-07)","text":"<ul> <li>Add support for ruby 3.3.*  (Charlie Savage)</li> <li>Remove support for ruby 2.7.*  (Charlie Savage)</li> <li>Fix crash caused by referencing Profile Ruby objects from Method objects that were being moved   by GC compaction (Charlie Savage)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#163-2023-04-20","level":2,"title":"1.6.3 (2023-04-20)","text":"<ul> <li>Remove debug code unintentionally left in ruby-prof command line program (Charlie Savage)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#162-2023-04-17","level":2,"title":"1.6.2 (2023-04-17)","text":"<ul> <li>Fix Profile#merge! implementation (asksurya)</li> <li>Fix ruby-prof command line program (Charlie Savage)</li> <li>Added CMakeLists.txt file (Charlie Savage)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#161-2023-02-21","level":2,"title":"1.6.1 (2023-02-21)","text":"<ul> <li>Fix loading C extension for MacOS (Charlie Savage)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#160-2023-02-20","level":2,"title":"1.6.0 (2023-02-20)","text":"<ul> <li>Add support for Ruby's compacting garbage collector (Charlie Savage)</li> <li>Add rbs signature files (Charlie Savage)</li> <li>Update rack adapter used for profiling Rails to include latest ruby-prof features (Charlie Savage)</li> <li>Add warnings for deprecated methods (Charlie Savage)</li> <li>Update tests to not use deprecated methods (Charlie Savage)</li> <li>Improve tests on OSX (Charlie Savage)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#150-2023-02-06","level":2,"title":"1.5.0 (2023-02-06)","text":"<ul> <li>Add new Profile#merge! method that merges results for threads/fibers that share the same root method (Charlie Savage)</li> <li>Expand API to allow creation of +Measurement+, +CallTree+, +MethodInfo+ and +Thread+ instances. This  was done to make is possible to write tests for the new Profile#merge! functionality (Charlie Savage)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#145-2022-12-27","level":2,"title":"1.4.5 (2022-12-27)","text":"<ul> <li>Look for ruby_prof extension built on install in the lib directory (Charlie Savage)</li> <li>Added Ruby 3.2.0 build for mingw-urct</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#144-2022-12-11","level":2,"title":"1.4.4 (2022-12-11)","text":"<ul> <li>Update tests for Ruby 3.1 (Charlie Savage)</li> <li>When tracing allocations always use the RUBY_INTERNAL_EVENT_NEWOBJ trace event. Previously GC stats could also be used, but that includes the creation of internal T_IMEMO objects makes reviewing results confusing (Charlie Savage)</li> <li>Remove :profile option that lets a user set the prefix on callgrind output files since KCacheGrind will not automatically show these files in its open dialog. Fixes #313. (Charlie Savage)</li> <li>Don't expose threads to Ruby that don't have a call tree. This can happen when a user is profiling memory usage and then sends a signint to the profiled process. New objects will be created in a new thread, but no method enter/exit trace events are generated by Ruby. Thus the thread has no call tree. Fixes #312 (Charlie Savage)</li> <li>Update github Actions - change 3.0 to '3.0', add Windows mswin (MSP-Greg)</li> <li>Add Ruby 3.1 to test matrix (Charlie Savage)</li> <li>Use normal weight text instead of bold in call strack printer output. Fixes #297 (Charlie Savage)</li> <li>Update VC project to Ruby 3.1 and Visual Studio 2022 (Charlie Savage)</li> <li>Fix marshaling of profile measure. Fixes #315 (Charlie Savage)</li> <li>CI: Omit duplicate 'bundle install'. PR #309 (Olle Jonsson)</li> <li>Fix typo. s/perecent/percent/ (Paarth Madan)</li> <li>Remove support for Ruby 2.5 and 2.6 which are now end of life (Charlie Savage)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#143-2021-02-16","level":2,"title":"1.4.3 (2021-02-16)","text":"<ul> <li>Remove trailing spaces (sergioro)</li> <li>Load \"ruby-prof.so\" with require_relative (sergioro)</li> <li>Use same file permissions for all test files (sergioro)</li> <li>Create tmp directory for test output (sergioro)</li> <li>Update git-ignore to add mkmf log (sergioro)</li> <li>Fix minitest warning about using MT_CPU instead of N (sergioro)</li> <li>Fix minitest warning \"Use assert_nil if expecting nil (sergioro)</li> <li>Add xcode project (Charlie Savage)</li> <li>Update test for Ruby 3.0 (Charlie Savage)</li> <li>Remove Ruby 2.4 support since it is no longer maintained (Charlie Savage)</li> <li>Replace travis status badge with github status badge (Charlie Savage)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#142-2020-11-3","level":2,"title":"1.4.2 (2020-11-3)","text":"<ul> <li>Do NOT use Ruby 2.7.0 and 2.7.1 with ruby-prof. A bug in those versions of ruby causes ruby-prof to not work. Version 2.7.2 works correctly.</li> <li>Fix crash caused be reallocating an internal stack that keeps tracks of frames after getting a reference to the top frame in the stack (Charlie Savage).</li> <li>Fix bug where the flat printer did not correctly report the correct measurement mode.</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#141-2020-05-14","level":2,"title":"1.4.1 (2020-05-14)","text":"<ul> <li>Fix compiling on older versions of gcc that do not default to c99 (Charlie Savage)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#140-2020-05-12","level":2,"title":"1.4.0 (2020-05-12)","text":"<ul> <li>API change - remove merge_fibers support since it resulted in incorrect results or crashes (Charlie Savage)</li> <li>Fix crash when profiling memory usage (Charlie Savage)</li> <li>When tracing execution correctly print out newobj tracepoint events (Charlie Savage)</li> <li>Remove no longer needed code for building extensions (Charlie Savage)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#132-2020-04-19","level":2,"title":"1.3.2 (2020-04-19)","text":"<ul> <li>Fix rack profiler so it is thread safe (Charlie Savage)</li> <li>Fix loading of prebuilt binaries on mingw64 to use Ruby's major and minor version (Charlie Savage)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#131-2020-03-11","level":2,"title":"1.3.1 (2020-03-11)","text":"<ul> <li>Add max_percent and filter_by options to flat printer (Sean McGivern)</li> <li>Include binary in mingw64 build (Charlie Savage)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#130-2020-02-22","level":2,"title":"1.3.0 (2020-02-22)","text":"<ul> <li>Update C code to use newer RTypedData API versus older RData API.</li> <li>Update C code to use rb_cObject versus the older, deprecated, rb_cData.</li> <li>Update memory management - CallInfo's now keep alive their owning Profile instances. Fixes crashes that   could happen in rare instances.</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#120-2020-01-23","level":2,"title":"1.2.0 (2020-01-23)","text":"<ul> <li>Fix call stack printer broken in version 1.0.0 (Charlie Savage)</li> <li>Ruby 2.7.0 support (Charlie Savage)</li> <li>Switch to Windows high precision timer for measuring wall time (Charlie Savage)</li> <li>Much better support for reverse call trees - if you start RubyProf at the bottom   of a call tree it will correctly calculate times as it ascends the tree (Charlie Savage)</li> <li>Port AggregateCallInfo from Ruby to C to increase performance</li> <li>API change - CallInfo has been renamed CallTree</li> <li>Fix crashes on Ruby 2.4.*</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#110-2019-12-14","level":2,"title":"1.1.0 (2019-12-14)","text":"<p>Changes</p> <ul> <li>Reimplement merge_fibers (Charlie Savage)</li> <li>Fix crash caused by threads being freed when profiles are freed (Charlie Savage)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#100-2019-07-29","level":2,"title":"1.0.0 (2019-07-29)","text":"<p>ruby-prof's development stretches all the way back to 2005. Fourteen years later, it seems time for version 1.0! Version 1.0 is a significant update that greatly improves the internals of ruby-prof and adds a number of improvements.</p> <p>Changes (Charlie Savage):</p> <ul> <li>Profiling is significantly faster - 5x in some cases</li> <li>Recursive profiles are finally handled correctly.  Yeah!!!</li> <li>Redesigned reports (Chirs Whitefield)</li> <li>New documentation website (https://ruby-prof.github.io)</li> <li>The ability to measure allocations and memory usage using a standard (unpatched) version of ruby</li> <li>The ability to save and reload profiling results for later analysis</li> <li>The ability track object allocations</li> </ul> <p>At the same time, it was also time to remove old code and deprecated methods. These changes include (Charlie Savage):</p> <ul> <li>Drop support for old versions of ruby. Currently 2.4 and up are required.</li> <li>Remove support for method elimination (instead use method exclusion).</li> <li>Remove the CPU_TIME measurement mode since it duplicates the PROCESS_TIME mode and required inline assembly code</li> <li>Remove the GC_TIME and GC_RUNS measurement modes since they required patched ruby versions. In modern ruby it is possible to reimplement this functionality, but it does not seem of that much value (shout out if you want it back).</li> <li>Merge the RubyProf::FlatPrinterWithLineNumbers printer into RubyProf::FlatPrinter.</li> <li>Removed support for RUBY_PROF_EDITOR_URI environment variable that specified the link scheme. This features was more confusing then helpful.</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0180-2019-05-27","level":2,"title":"0.18.0 (2019-05-27)","text":"","path":["Changelog"],"tags":[]},{"location":"changelog/#fixes","level":3,"title":"Fixes","text":"<ul> <li>Fix grouping by thread/fiber (Charlie Savage)</li> <li>Fix include/exclude thread checking (Charlie Savage)</li> <li>Fix failing tests (Charlie Savage)</li> <li>Fix grouping by thread_id and fiber_id (Charlie Savage)</li> <li>Update Visual Studio solution to 2019 (Charlie Savage)</li> <li>Adjust AbstractPrinter#editor_uri so it's possible to disable uri (Maciek Dubiński)-</li> <li>Fix -X/--exclude-file option not working (John Lindgren)</li> <li>Different directory for middleware output in readme (Aldric Giacomoni)</li> <li>Fixing spelling mistakes and typos (David Kennedy and Roger Pack)</li> <li>Add \"allow_exceptions\" option to Profile (Ryan Duryea)</li> <li>Update readme (Jan Piotrowski, Nathan Seither, victor-am)</li> <li>Travis updates (Niocals Leger and Charlie Savage)</li> <li>Fix NewRelic module detection in exclude_common_methods! (Ben Hughes)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0170-2017-12-17","level":2,"title":"0.17.0 (2017-12-17)","text":"<ul> <li>Changed method/class names produced by the callgrind printer to be more kcachegrind   friendly (thx to Nelson Gauthier and Ben Hughes, see https://github.com/ruby-prof/ruby-prof/pull/200).</li> <li>Recursive instances of a method call are now dtected during profiling (thx to Nelson Gauthier and   Ben Hughes, see https://github.com/ruby-prof/ruby-prof/pull/201).</li> <li>Methods can now be ignored during a profiling run instead of eliminating them   after a profile run, which has been deprecated (thx to Nelson Gauthier and Ben Hughes,   see https://github.com/ruby-prof/ruby-prof/pull/202).</li> <li>Use RUBY_PROF_EDITOR_URI=emacs to open source code links in the one true editor.   (thx Alexander Egorov, see https://github.com/ruby-prof/ruby-prof/pull/183 and   https://github.com/typester/emacs-handler).</li> <li>Fixed that calling profile.stop would stop profiling all active profiling runs.</li> <li>Fixed that remembering parent call frame pointer before stack reallocation could cause a segfault.</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0162-2016-08-25","level":2,"title":"0.16.2 (2016-08-25)","text":"<ul> <li>fixed incorrect setting of RUBY_VERSION macro</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0161-2016-08-24","level":2,"title":"0.16.1 (2016-08-24)","text":"<ul> <li>fixed compile problem with ruby 2.1.10</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0160-2016-08-24","level":2,"title":"0.16.0 (2016-08-24)","text":"<ul> <li>ruby-prof can now be installed if ruby has been compiled with --disable-gems or   RUBYOPT includes --disable-gems (thx to Arthur Nogueira Neves)</li> <li>Profile.new now accepts and prefers an options hash:</li> <li>measure_mode: one of the RubyProf measure mode constants</li> <li>exclude_threads: an array of threads to ignore when collecting profile data</li> <li>include_threads: an array of threads to include when collecting profile data</li> <li>merge_fibers: whether or not to merge the profile data for all fibers under their creating thread</li> <li>overhauled printer for cachegrind profiles:</li> <li>profile data for each thread dumped to a separate file, as kcachegrind does not     fully implement the cachegrind specification</li> <li>this required a change in interface: it's now necessary to specify a directory     where to dump the cachegrind files</li> <li>naming convention for cachegrind files changed so that kcachegrind shows them     all in the open dialog</li> <li>improved Rack middleware:</li> <li>it's now possible to use the MultiPrinter</li> <li>new option ignore_existing_threads: will ignore all prexisiting threads     when profiling a request, except the thread perfoming the request.</li> <li>new option request_thread_only: will ignore all preexisting threads, but also     all threads spwaned during the execution of the rack request.</li> <li>new option merge_fibers: whether or not to merge the profile data for all fibers under their creating thread</li> <li>fixed setting threshold bug when displaying stack profiles (thx to Michal Konarski)</li> <li>code related to printing profiles is now autoloaded for efficiency (thx to Dave Gynn)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0159-2015-12-08","level":2,"title":"0.15.9 (2015-12-08)","text":"<ul> <li>rack profiler now supports lambdas for generating profile paths (thx to Jean Rougé)</li> <li>fixed a bug when printing graph profiles</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0158-2015-04-24","level":2,"title":"0.15.8 (2015-04-24)","text":"<ul> <li>added missing assets to gem build</li> <li>fixed randomly failing test</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0157-2015-04-23","level":2,"title":"0.15.7 (2015-04-23)","text":"<ul> <li>html profiles are now single page (thx to Thomas Leishman)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0156-2015-02-22","level":2,"title":"0.15.6 (2015-02-22)","text":"<ul> <li>improved upon computing children time in graph printers</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0155-2015-02-22","level":2,"title":"0.15.5 (2015-02-22)","text":"<ul> <li>changed output format of flat_printer_with_line_number</li> <li>support using multi printer from command line (Dov Murik)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0154-2015-02-14","level":2,"title":"0.15.4 (2015-02-14)","text":"<ul> <li>using env variable to specify mesaurement mode work again</li> <li>measuring memory/object allocations works for 2.1 adn 2.2 again</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0153-2015-01-16","level":2,"title":"0.15.3 (2015-01-16)","text":"<ul> <li>support ruby 2.2.0</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0152-2014-05-20","level":2,"title":"0.15.2 (2014-05-20)","text":"<ul> <li>rack middleware creates print dir for profile result (Neng)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0151-2014-05-20","level":2,"title":"0.15.1 (2014-05-20)","text":"<ul> <li>added license to gemspec</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0150-2014-05-02","level":2,"title":"0.15.0 (2014-05-02)","text":"<ul> <li>improved cpu time measurement (Charlie Somerville)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0142-2014-01-05","level":2,"title":"0.14.2 (2014-01-05)","text":"<ul> <li>hopefully fixed compile problem under Windows</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0140-2014-01-02","level":2,"title":"0.14.0 (2014-01-02)","text":"<ul> <li>support ruby 2.1.0</li> <li>dropped support for 1.8.x, 1.9.1 and 1.9.2</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0131-2013-12-14","level":2,"title":"0.13.1 (2013-12-14)","text":"<ul> <li>speed up for displaying large call stacks (Benjamin Quoming)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#013-2013-03-10","level":2,"title":"0.13 (2013-03-10)","text":"<ul> <li>support fibers on 1.9.x+</li> <li>improved display for very wide call stacks (Sammy Larbi)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0122-2013-02-13","level":2,"title":"0.12.2 (2013-02-13)","text":"<ul> <li>Fixed segfault when using falcon or railsexpress patches for 1.9.3</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0121-2013-01-07","level":2,"title":"0.12.1 (2013-01-07)","text":"<ul> <li>Add back in pause/resume support since Rails uses it</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0120-2013-01-06","level":2,"title":"0.12.0 (2013-01-06)","text":"<ul> <li>Ruby 2.0.0 support (Charlie Savage)</li> <li>Fix issue where profiling results could exceed 100% if profile code had multiple top level methods (Charlie Savage)</li> <li>Replaced RubyProf::Thread#top_method with RubyProf::Thread#top_methods (Charlie Savage)</li> <li>Added RubyProf::Thread#total_time (Charlie Savage)</li> <li>Remove the -r and -e command line options.  If you need specific libraries or code profiled then add them   to your code (Charlie Savage).</li> <li>Rewrite ruby-prof script to be more self-contained (Gary Weaver)</li> <li>Fix list formatting in readme (Thilo Rusche)</li> <li>Remove pause/resume support since its buggy and complicates the code</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0113-2012-12-27","level":2,"title":"0.11.3 (2012-12-27)","text":"<ul> <li>Prefix c functions with prof_ to avoid name conflicts (Kenta Murata)</li> <li>Update ruby-prof script to avoid seg faults (Gary Weaver)</li> <li>Rakefile updates (Roger Pack)</li> <li>Fix regexp file reading (Gilbert Roulot)</li> <li>Update documentation (Timo Schilling)</li> <li>Fix up ruby warnings (Mike Gehard)</li> <li>Remove duplicate code (Chas Lemley)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0112-2012-05-06","level":2,"title":"0.11.2 (2012-05-06)","text":"<ul> <li>Fix compile issue with BOOL.  Should be _Bool for C99.</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0111-2012-05-06","level":2,"title":"0.11.1 (2012-05-06)","text":"<ul> <li>Added option --exclude-common-callbacks, plus exclude #map and #inject in common cycles (Vasily Fedoseyev)</li> <li>Add option --exclude-common-cycles to exclude common iterators (Vasily Fedoseyev)</li> <li>Allow method elimination from command line via '-x' and '-X' keys (Vasily Fedoseyev)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0110-2012-05-05","level":2,"title":"0.11.0 (2012-05-05)","text":"<ul> <li>Fix pause/resume so it actually works and add tests (David Barri)</li> <li>Resume now returns the result of the block when given (David Barri)</li> <li>Make recursive method explanation more clear (Charlie Savage)</li> <li>Fix ruby warnings (Charlie Savage)</li> <li>Toggle GC.enable_stats when profiling for memory to get the data (Vasily Fedoseyev)</li> <li>Fix patched ruby support and remove some warnings (Vasily Fedoseyev)</li> <li>Fix tests on 1.8.7 (rogerdpack)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0110rc3-2012-03-26","level":2,"title":"0.11.0.rc3 (2012-03-26)","text":"<ul> <li>Include missing files in gemspec (Charlie Savage).</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0110rc2-2012-03-25","level":2,"title":"0.11.0.rc2 (2012-03-25)","text":"<ul> <li>Lots of improvements to Rack handler - this can be used to profile requests   in Rails and other rack-based ruby web frameworks (Charlie Savage).</li> <li>Reimplemented handling of recursive calls using CallInfoVisitor (Charlie Savage).</li> <li>Fix bug where child times were not correctly reported in complicated   call graphs with recursion like in frameworks like Rails (Charlie Savage).</li> <li>Add in recursive call information to Flat, Graph and Graph HTML reports (Charlie Savage).</li> <li>Add in new thread class add added RubyProf::Thread#top_method to   make report generation easier (Charlie Savage).</li> <li>Add in CallInfoVisitor class to make it easy to iterate over a call graph (Charlie Savage).</li> <li>Add in CallInfoPrinter to make it visualize RubyProf's internal call graphs (Charlie Savage).</li> <li>Significant updates to documentation (Charlie Savage).</li> <li>More c code cleanup (Charlie Savage).</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0110rc1-2012-03-24","level":2,"title":"0.11.0.rc1 (2012-03-24)","text":"<ul> <li>Big internal refactoring of C code to make RubyProf easier to understand and extend (Charlie Savage).</li> <li>Profile results are now returned as instances of a new class RubyProf::Profile.  The old api   is supported via a compatability layer that at some point will be deprecated.  (Charlie Savage).</li> <li>On Windows, use QueryPerformanceCounter and QueryPerformanceFrequency to measure CPU time instead   of rdtsc.  This change is based on Microsoft's recommendation (Charlie Savage).</li> <li>On Windows use GetProcessTimes to return real PROCESS_TIME times instead of wall times (Charlie Savage).</li> <li>Split out tests for each time of measurement (cpu_time, process_time, etc.) (Charlie Savage).</li> <li>Dropped support for Ruby 1.8.4 and 1.8.6 and 1.9.0 (Charlie Savage).</li> <li>Added support for sorting results by total, self, wait and child times (Jan Suchal)</li> <li>Added tests for sorting behaviour &amp; removed options from constructor to print method (Jan Suchal)</li> <li>Fix line number tests due to changes at top of file (Charlie Savage).</li> <li>Add encoding statement to top of all files for Ruby 1.9.x compatability (Charlie Savage).</li> <li>Add def file for VC to avoid the whole declspec annoyance (Charlie Savage).</li> <li>Update test suite to ensure current working directory is correct (Charlie Savage).</li> <li>Modernize gem file and remove various custom/home grown solutions that aren't needed anymore (Charlie Savage).</li> <li>Remove custom mingw build scripts, use rake compiler instead  (Charlie Savage).</li> <li>Fixes for compiling with VC 2010 (Charlie Savage).</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0108-2011-07-06","level":2,"title":"0.10.8 (2011-07-06)","text":"<ul> <li>1.9.3 super class (Roger Pack)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0107-2011-05-09","level":2,"title":"0.10.7 (2011-05-09)","text":"<ul> <li>Fix a bug with REE's GC stats. Issue #53 [thanks graaff]</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0106-2011-04-29","level":2,"title":"0.10.6 (2011-04-29)","text":"<ul> <li>Slightly more normalized url for linux/windows links to files.</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0105-2011-04-20","level":2,"title":"0.10.5 (2011-04-20)","text":"<ul> <li>1.8.6 compat for -v command (bug fix)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0104-2011-04-20","level":2,"title":"0.10.4 (2011-04-20)","text":"<ul> <li>Faster load time for ruby-prof itself.</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0103","level":2,"title":"0.10.3","text":"<ul> <li>Can cleanly load before rubygems now.</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0102","level":2,"title":"0.10.2","text":"<ul> <li>Fix for 1.9.2, os x for latest commits (thanks skaes!)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0101","level":2,"title":"0.10.1","text":"<ul> <li>Fix bug in linux wall time, also load with only relative paths so that you can use it to benchmark rubygems startup overhead,   itself.</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0100","level":2,"title":"0.10.0","text":"<ul> <li>Some rdoc changes, for linux wall time attempt to use higher granularity (thanks to all the contributors for this round!)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#092","level":2,"title":"0.9.2","text":"<ul> <li>Make graphviz work on 1.8.6</li> <li>Roll back some 1.9.2 optimizations until I can figure out what caused them.</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#091","level":2,"title":"0.9.1","text":"<ul> <li>Add a graphviz output</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#090","level":2,"title":"0.9.0","text":"<ul> <li>measurements for recursive methods are now correct</li> <li>gave up on splitting up recursive methods according to call depth</li> <li>made it possible to eliminate methods from profiling results</li> <li>new printer for call stack visualization</li> <li>new printer to print several profiles in one run</li> <li>HTML profiles contain Textmate links so you can jump to the source code easily</li> <li>producing an event log is now a runtime option</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#0710-2009-01-22","level":2,"title":"0.7.10 (2009-01-22)","text":"<ul> <li>fix SEGFAULT in 1.9</li> <li>add new printer flat_printer_with_line_numbers</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#077-2009-01-13","level":2,"title":"0.7.7 (2009-01-13)","text":"<ul> <li>\"fix\" multi threading support for 1.9 http://redmine.ruby-lang.org/issues/show/2012</li> <li>speedups</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#076-2009-12-31","level":2,"title":"0.7.6 (2009-12-31)","text":"<ul> <li>fix some tests for 1.9 (no real code changes)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#075-2009-12","level":2,"title":"0.7.5 (2009-12)","text":"<ul> <li>fix a GC collection bug (nobu's patch).</li> <li>correctly report recursive call depths (Kevin Scaldeferri).</li> <li>sort methods on output (Kevin Scaldeferri).</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#073-2008-12-09","level":2,"title":"0.7.3 (2008-12-09)","text":"<ul> <li>Fixed compile error with new x86_64 code using GCC.</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#072-2008-12-08","level":2,"title":"0.7.2 (2008-12-08)","text":"<ul> <li> <p>Fixed major bug in printing child methods in graph reports.</p> </li> <li> <p>Fixes for supporting x86_64 machines (Diego Pettenò)</p> </li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#071-2008-11-28","level":2,"title":"0.7.1 (2008-11-28)","text":"<ul> <li>Added new AggregateCallTree class for printers to   make results easier to read.  Take this call sequence   for example:</li> </ul> <p>A   B   C    |   |   |    Z   A   A        |   |        Z   Z</p> <p>By default, ruby-prof will show that Z was called by 3 separate   instances of A.  In an IDE that is helpful but in a text report   it is not since it makes the report much harder to read.   As a result, printers now aggregate together callers (and children),   matching ruby-prof's output from versions prior to 0.7.0.</p> <ul> <li>Fixes for supporting x86_64 machines (Matt Sanford)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#070-2008-11-04","level":2,"title":"0.7.0 (2008-11-04)","text":"","path":["Changelog"],"tags":[]},{"location":"changelog/#features_1","level":3,"title":"Features","text":"<ul> <li>Added two new methods - RubyProf.resume and RubyProf.pause.   RubyProf.resume takes an optional block, which ensures that   RubyProf.pause is called.  For example:</li> </ul> <p>10.times do |i|     RubyProf.resume do       # Some long process     end   end</p> <p>result = RubyProf.stop</p> <ul> <li> <p>Added support for profiling tests that use Ruby's built-in   unit test framework (ie, test derived from   Test::Unit::TestCase).  To enable profiling simply add   the following line of code to your test class:</p> <p>include RubyProf::Test</p> </li> </ul> <p>By default, profiling results are written to the current   processes working directory.  To change this, or other   profiling options, simply modify the PROFILE_OPTIONS hash   table as needed.</p> <ul> <li> <p>Used the new support for profiling test cases to revamp   the way that Rails profiling works.  For more information   please refer to RubyProf's documentation.</p> </li> <li> <p>Keep track of call stack for each method to enable more   powerful profile visualizations in Integrated Development   Environments (Hin Boean, work supported by CodeGear).</p> </li> <li> <p>Expose measurements to Ruby (Jeremy Kemper).</p> </li> <li> <p>Add support for additional memory measurements modes in Ruby 1.9 (Jeremy Kemper).</p> </li> <li> <p>Add support for Lloyd Hilaiel's Ruby patch for measuring total heap size.    See http://lloydforge.org/projects/ruby. (Jeremy Kemper).</p> </li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#fixes_1","level":3,"title":"Fixes","text":"<ul> <li> <p>RubyProf.profile no longer crashes if an exception is   thrown during a profiling run.</p> </li> <li> <p>Measure memory in fractional kilobytes rather than rounding down (Jeremy Kemper)</p> </li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#060-2008-02-03","level":2,"title":"0.6.0 (2008-02-03)","text":"<p>ruby-prof 0.6.0 adds support for Ruby 1.9 and memory profiling.</p>","path":["Changelog"],"tags":[]},{"location":"changelog/#features_2","level":3,"title":"Features","text":"<ul> <li>Added support for ruby 1.9 (Shugo Maeda)</li> <li>Added support for outputting printer results to a String, Array or IO   object (Michael Granger)</li> <li>Add new memory profiling mode.  Note this mode depends on a   patched Ruby interpreter (Alexander Dymo)</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#fixes_2","level":3,"title":"Fixes","text":"<ul> <li>Improvements to GraphHtmlPrinter including updated documentation,   fixes for min_time support, ability to specify templates using   strings or filenames, and table layout fixes (Makoto Kuwata)</li> <li>Fixes to scaling factor for calltrees so that precision is not lost   due to the conversion to doubles (Sylvain Joyeux)</li> <li>Changed constant ALLOCATED_OBJECTS to ALLOCATIONS in the C code to   match the Ruby code (Sylvain Joyeux)</li> <li>Added support for calltree printer to ruby-prof binary script (Sylvain Joyeux)</li> <li>Fix support for the allocator measure mode to extconf.rb (Sylvain Joyeux)</li> <li>Honor measure mode when specified on the command line (Sylvain Joyeux)</li> <li>Sorting of methods by total time was incorrect (Dan Fitch, Charlie Savage)</li> <li>Fix ruby-prof to work with the latest version of GEMS (Alexander Dymo)</li> <li>Always define MEASURE_CPU_TIME and MEASURE_ALLOCATIONS in Ruby code, but   set their values to nil if the functionality is not available.</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#052-2007-07-19","level":2,"title":"0.5.2 (2007-07-19)","text":"<p>ruby-prof 0.5.2 is a bug fix release.</p>","path":["Changelog"],"tags":[]},{"location":"changelog/#fixes_3","level":3,"title":"Fixes","text":"<ul> <li>Include missing rails plugin</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#051-2007-07-18","level":2,"title":"0.5.1 (2007-07-18)","text":"<p>ruby-prof 0.5.1 is a bug fix and performance release.</p>","path":["Changelog"],"tags":[]},{"location":"changelog/#performance","level":3,"title":"Performance","text":"<ul> <li>Significantly reduced the number of thread lookups by   caching the last executed thread.</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#fixes_4","level":3,"title":"Fixes","text":"<ul> <li>Properly escape method names in HTML reports</li> <li>Fix use of -m and --min-percent command line switches</li> <li>Default source file information to ruby_runtime#0 for c calls</li> <li>Moved rails_plugin to top level so it is more obvious</li> <li>Updated rails_plugin to write reports to the current   Rails log directory</li> <li>Added additional tests</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#050-2007-07-09","level":2,"title":"0.5.0 (2007-07-09)","text":"","path":["Changelog"],"tags":[]},{"location":"changelog/#features_3","level":3,"title":"Features","text":"<ul> <li>Added support for timing multi-threaded applications</li> <li>Added support for 64 bit systems (patch from Diego 'Flameeyes' Petten)</li> <li>Added suport for outputting data in the format used by   KCacheGrind (patch from Carl Shimer)</li> <li>Add filename and line numbers to call tree information (patch from Carl Shimer)</li> <li>Added Visual Studio 2005 project file.</li> <li>Added replace-progname switch, als rcov.</li> <li>Added better support for recursive methods</li> <li>Added better support for profiling Rails applications</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#fixes_5","level":3,"title":"Fixes","text":"<ul> <li>Fixes bug when the type of an attached object (singleton) is inherited   from T_OBJECT as opposed to being a T_OBJECT (identified by Francis Cianfrocca)</li> <li>ruby-prof now works in IRB.</li> <li>Fix sort order in reports.</li> <li>Fixed rdoc compile error.</li> <li>Fix tabs in erb template for graph html report on windows.</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#041-2006-06-26","level":2,"title":"0.4.1 (2006-06-26)","text":"","path":["Changelog"],"tags":[]},{"location":"changelog/#features_4","level":3,"title":"Features","text":"<ul> <li>Added a RubyProf.running? method to indicate whether a profile is in progress.</li> <li>Added tgz and zip archives to release</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#fixes_6","level":3,"title":"Fixes","text":"<ul> <li>Duplicate method names are now allowed</li> <li>The documentation has been updated to show the correct API usage is RubyProf.stop not RubyProf.end</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#040-2006-06-16","level":2,"title":"0.4.0 (2006-06-16)","text":"","path":["Changelog"],"tags":[]},{"location":"changelog/#features_5","level":3,"title":"Features","text":"<ul> <li>added support for call graphs</li> <li>added support for printers.  Currently there is a FlatPrinter,   GraphPrinter and GraphHtmlPrinter.</li> <li>added support for recursive methods</li> <li>added Windows support</li> <li>now packaged as a RubyGem</li> </ul>","path":["Changelog"],"tags":[]},{"location":"changelog/#fixes_7","level":3,"title":"Fixes","text":"<ul> <li>Fixes bug where RubyProf would crash depending on the   way it was invoked - for example, it did not run when   used with Arachno Ruby's customized version of Ruby.</li> </ul>","path":["Changelog"],"tags":[]},{"location":"getting-started/","level":1,"title":"Getting Started","text":"<p>There are three ways to use ruby-prof:</p> <ul> <li>command line</li> <li>convenience API</li> <li>core API</li> </ul>","path":["Getting Started"],"tags":[]},{"location":"getting-started/#command-line","level":2,"title":"Command Line","text":"<p>The easiest way to use ruby-prof is via the command line, which requires no modifications to your program. The basic usage is:</p> <pre><code>ruby-prof [options] &lt;script.rb&gt; [--] [script-options]\n</code></pre> <p>Where script.rb is the program you want to profile.</p> <p>For a full list of options, see the RubyProf::Cmd documentation or execute the following command:</p> <pre><code>ruby-prof -h\n</code></pre>","path":["Getting Started"],"tags":[]},{"location":"getting-started/#convenience-api","level":2,"title":"Convenience API","text":"<p>The second way to use ruby-prof is via its convenience API. This requires small modifications to the program you want to profile:</p> <pre><code>require 'ruby-prof'\n\nprofile = RubyProf::Profile.new\n\n# profile the code\nprofile.start\n# ... code to profile ...\nresult = profile.stop\n\n# print a flat profile to text\nprinter = RubyProf::FlatPrinter.new(result)\nprinter.print(STDOUT)\n</code></pre> <p>Alternatively, you can use a block to tell ruby-prof what to profile:</p> <pre><code>require 'ruby-prof'\n\n# profile the code\nresult = RubyProf::Profile.profile do\n  # ... code to profile ...\nend\n\n# print a graph profile to text\nprinter = RubyProf::GraphPrinter.new(result)\nprinter.print(STDOUT)\n</code></pre> <p>ruby-prof also supports pausing and resuming profiling runs.</p> <pre><code>require 'ruby-prof'\n\nprofile = RubyProf::Profile.new\n\n# profile the code\nprofile.start\n# ... code to profile ...\n\nprofile.pause\n# ... other code ...\n\nprofile.resume\n# ... code to profile ...\n\nresult = profile.stop\n</code></pre> <p>Note that resume will only work if start has been called previously. In addition, resume can also take a block:</p> <pre><code>require 'ruby-prof'\n\nprofile = RubyProf::Profile.new\n\n# profile the code\nprofile.start\n# ... code to profile ...\n\nprofile.pause\n# ... other code ...\n\nprofile.resume do\n  # ... code to profile...\nend\n\nresult = profile.stop\n</code></pre> <p>With this usage, resume will automatically call pause at the end of the block.</p> <p>The <code>RubyProf::Profile.profile</code> method can take various options, which are described in Profiling Options.</p>","path":["Getting Started"],"tags":[]},{"location":"getting-started/#core-api","level":2,"title":"Core API","text":"<p>The convenience API is a wrapper around the <code>RubyProf::Profile</code> class. Using the Profile class directly provides additional functionality, such as method exclusion.</p> <p>To create a new profile:</p> <pre><code>require 'ruby-prof'\n\nprofile = RubyProf::Profile.new(measure_mode: RubyProf::WALL_TIME)\nresult = profile.profile do\n           ...\n         end\n</code></pre> <p>Once a profile is completed, you can either generate a report via a printer or save the results for later analysis. For a list of profiling options, please see the Profiling Options section. If you are unsure which report to generate first, see Report Types.</p> <p>However, using ruby-prof also comes with two caveats:</p> <ul> <li>To use ruby-prof you generally need to include a few lines of extra code in your program (although see command line usage)</li> <li>Using ruby-prof will cause your program to run slower (see Performance section)</li> </ul> <p>Most of the time, these two caveats are acceptable. But if you need to determine why a program running in production is slow or hung, a sampling profiler will be a better choice. Excellent choices include stackprof or rbspy.</p> <p>If you are just interested in memory usage, you may also want to checkout the memory_profiler gem (although ruby-prof provides similar information).</p>","path":["Getting Started"],"tags":[]},{"location":"history/","level":1,"title":"History","text":"<p>For a full list of changes between versions, see the Changelog.</p> <p>The first version of ruby-prof, 0.1.1, was released on March 22, 2005 by Shugo Maeda The original source code is still available on his website (it is not actually in the git history). ruby-prof was a vast improvement at the time, running 30 times faster as the original ruby profiler.</p> <p>Version 0.4.0 was the first version packaged as a Ruby gem. Version 0.4.0 also introduced Windows support, thread support and added a number of additional reports such as the graph report in HTML and the call graph report.</p> <p>A number of versions were subsequently released, with a 1.0.0 release finally happening in July of 2019. Version 1.0.0 was a major rewrite that significantly improved performance, correctly profiled recursive methods, redesigned reports, added allocation/memory measurement support and introduced saving and reloading profiling results. Since then ruby-prof has continued to evolve along with Ruby with 19 releases.</p> <p>Version 2.0.0 will mark the 20<sup>th</sup> release of ruby-prof since the 1.0.0 release. Version 2.0.0 supports Ruby 4 and includes new flame/icicle graph support, revamped reports and improved documentation. The reason for the 2.0.0 jump is because profiling memory sizes has been removed due to changes in Ruby 4.0.0. In addition, the old compatibility API was also removed.</p>","path":["History"],"tags":[]},{"location":"profiling-rails/","level":1,"title":"Profiling Rails","text":"<p>To profile a Rails application it is vital to run it using production-like settings (cache classes, cache view lookups, etc.). Otherwise, Rails dependency loading code will overwhelm any time spent in the application itself (our tests show that Rails dependency loading causes a roughly 6x slowdown). The best way to do this is to create a new Rails environment, <code>profile</code>.</p> <p>To profile Rails:</p> <ol> <li>Add ruby-prof to your Gemfile:</li> </ol> <pre><code>group :profile do\n  gem 'ruby-prof'\nend\n</code></pre> <p>Then install it:</p> <pre><code>bundle install\n</code></pre> <ol> <li>Create <code>config/environments/profile.rb</code> with production-like settings and the ruby-prof middleware:</li> </ol> <pre><code># config/environments/profile.rb\nrequire_relative \"production\"\n\nRails.application.configure do\n  # Optional: reduce noise while profiling.\n  config.log_level = :warn\n\n  # Optional: disable controller/view caching if you want raw app execution timing.\n  config.action_controller.perform_caching = false\n\n  config.middleware.use Rack::RubyProf, path: Rails.root.join(\"tmp/profile\")\nend\n</code></pre> <p>By default the rack adapter generates flat text, graph text, graph HTML, and call stack HTML reports.</p> <ol> <li>Start Rails in the profile environment:</li> </ol> <pre><code>bin/rails server -e profile\n</code></pre> <p>You can run a console in the same environment with:</p> <pre><code>bin/rails console -e profile\n</code></pre> <ol> <li>Make a request to generate profile output:</li> </ol> <pre><code>curl http://127.0.0.1:3000/\n</code></pre> <ol> <li>Inspect reports in <code>tmp/profile</code>:</li> </ol> <pre><code>ls -1 tmp/profile\n</code></pre> <p>Reports are generated per request path. Repeating the same request path overwrites the previous report files for that path.</p>","path":["Profiling Rails"],"tags":[]},{"location":"reports/","level":1,"title":"Reports","text":"<p>Once you have completed a profiling run, you will want to generate a report to analyze the results. One of ruby-prof's strengths is the number of ways it lets you visualize profiling results, from quick text summaries to interactive HTML views and external tooling formats. The following table shows all supported report types and when to use them:</p> <p>For repeatable profiling workflow guidance, see Best Practices.</p> Name Best For <code>FlatPrinter</code> Finding hottest methods fast (best quick signal by self time) <code>GraphPrinter</code> Understanding who called a hot method (caller/callee context in text) <code>GraphHtmlPrinter</code> Exploring large call graphs interactively (clickable navigation) <code>FlameGraphPrinter</code> Seeing hot paths visually (where time accumulates) <code>CallStackPrinter</code> Inspecting execution-path dominance (tree of major runtime paths) <code>CallTreePrinter</code> Using external profiler tooling (KCachegrind/callgrind format) <code>CallInfoPrinter</code> Debugging ruby-prof internals/data shape (low-level call-tree details) <code>MultiPrinter</code> Generating several outputs at once (one run, multiple files) <p>Recommended workflow:</p> <ol> <li>Run <code>FlatPrinter</code> to find top offenders.</li> <li>Use <code>GraphHtmlPrinter</code> (or <code>GraphPrinter</code>) to understand caller/callee relationships.</li> <li>Use <code>FlameGraphPrinter</code> to visually validate dominant paths.</li> </ol>","path":["Reports"],"tags":[]},{"location":"reports/#creating-reports","level":2,"title":"Creating Reports","text":"<p>Reports are created via the use of printers:</p> <pre><code>profile = RubyProf::Profile.profile do\n            ...\n          end\nprinter = RubyProf::GraphPrinter.new(profile)\nprinter.print(STDOUT, min_percent: 2)\n</code></pre> <p>The first parameter is any writable IO object such as STDOUT or a file. All printers accept the following keyword arguments:</p> Option Default Description <code>min_percent</code> <code>0</code> Minimum %self time for a method to be included (0–100). <code>max_percent</code> <code>100</code> Maximum %self time for a method to be included (0–100). <code>filter_by</code> <code>:self_time</code> Which time metric to use when applying <code>min_percent</code> and <code>max_percent</code>. <code>sort_method</code> varies How to sort methods. Values: <code>:total_time</code>, <code>:self_time</code>, <code>:wait_time</code>, <code>:children_time</code>.","path":["Reports"],"tags":[]},{"location":"reports/#report-types","level":2,"title":"Report Types","text":"","path":["Reports"],"tags":[]},{"location":"reports/#flat","level":3,"title":"Flat","text":"<p>The flat report shows the overall time spent in each method. It is a good way of quickly identifying which methods take the most time. Use <code>RubyProf::FlatPrinter</code> to generate this report. Default <code>sort_method</code> is <code>:self_time</code>. (example)</p> <p></p>","path":["Reports"],"tags":[]},{"location":"reports/#graph-text","level":3,"title":"Graph (Text)","text":"<p>The graph report shows the overall time spent in each method. In addition, it also shows which methods call the current method and which methods it calls. Thus they are good for understanding how methods get called and provide insight into the flow of your program. Use <code>RubyProf::GraphPrinter</code> to generate this report. Default <code>sort_method</code> is <code>:total_time</code>. (example)</p> <p></p>","path":["Reports"],"tags":[]},{"location":"reports/#graph-html","level":3,"title":"Graph (HTML)","text":"<p>HTML Graph profiles are the same as graph reports, except output is generated in hyper-linked HTML. Since graph reports can be quite large, the embedded links make it much easier to navigate the results. Use <code>RubyProf::GraphHtmlPrinter</code> to generate this report. Default <code>sort_method</code> is <code>:total_time</code>. (example)</p> <p></p> <p>Additional options:</p> Option Default Description <code>min_time</code> <code>nil</code> Minimum total time (in seconds) for a method to be shown. <code>nonzero</code> <code>false</code> When <code>true</code>, sets <code>min_time</code> to 0.005 if <code>min_time</code> is not specified.","path":["Reports"],"tags":[]},{"location":"reports/#flame-graph","level":3,"title":"Flame Graph","text":"<p>Flame graph reports produce a self-contained HTML visualization of the profiled code. Each method is represented as a horizontal bar whose width is proportional to its total time. Bars are stacked vertically by call depth, making it easy to identify hot code paths at a glance. A toggle switches between flame (bottom-up) and icicle (top-down) views. Use <code>RubyProf::FlameGraphPrinter</code> to generate this report. (example)</p> <p></p> <p>Interactive features include hover tooltips (showing method name, self time, total time, percentage, and call count), click-to-zoom into a subtree, a reset zoom button, a search box to highlight matching methods, and a thread selector when multiple threads are profiled.</p> <pre><code>printer = RubyProf::FlameGraphPrinter.new(result)\nprinter.print(File.open(\"flame_graph.html\", \"w\"))\n</code></pre> <p>Additional options:</p> Option Default Description <code>title</code> <code>\"ruby-prof flame graph\"</code> Title displayed in the HTML report.","path":["Reports"],"tags":[]},{"location":"reports/#call-stack","level":3,"title":"Call Stack","text":"<p>Call stack reports produce a HTML visualization of the time spent in each execution path of the profiled code. Use <code>RubyProf::CallStackPrinter</code> to generate this report. (example)</p> <p></p> <p>Additional options:</p> Option Default Description <code>title</code> <code>\"ruby-prof call stack\"</code> Title displayed in the HTML report. <code>threshold</code> <code>1.0</code> Minimum %total for a node to be visible (0–100). <code>expansion</code> <code>10.0</code> Minimum %total for a node to be expanded by default (0–100). <code>application</code> <code>$PROGRAM_NAME</code> Application name displayed in the report.","path":["Reports"],"tags":[]},{"location":"reports/#graphviz","level":3,"title":"Graphviz","text":"<p>The graphviz report is designed to be opened by Graphviz to create visualization of profile results. The output can be visualized using the Graphviz Online viewer. Use <code>RubyProf::DotPrinter</code> to generate this report. (example, view online)</p> <p></p>","path":["Reports"],"tags":[]},{"location":"reports/#cachegrind","level":3,"title":"Cachegrind","text":"<p>Cachegrind output results in the calltree profile format which is used by KCachegrind. More information about the format can be found at the KCachegrind site. Use <code>RubyProf::CallTreePrinter</code> to generate this report. (example)</p> <p>Additional options:</p> Option Default Description <code>path</code> <code>\".\"</code> Directory where callgrind output files are written.","path":["Reports"],"tags":[]},{"location":"reports/#call-info-report","level":3,"title":"Call Info Report","text":"<p>Call info reports print the call tree with timing information for each node. This is mainly useful for debugging purposes as it provides access into ruby-prof's internals. Use <code>RubyProf::CallInfoPrinter</code> to generate this report. (example)</p>","path":["Reports"],"tags":[]},{"location":"reports/#multiple-reports","level":3,"title":"Multiple Reports","text":"<p><code>RubyProf::MultiPrinter</code> can generate several reports in one profiling run. It requires a directory path and a profile basename for the files it produces:</p> <pre><code>printer = RubyProf::MultiPrinter.new(result)\nprinter.print(path: \".\", profile: \"profile\")\n</code></pre> Option Default Description <code>path</code> <code>\".\"</code> Directory where report files are written. <code>profile</code> <code>\"profile\"</code> Base filename for the generated reports. <p>All other keyword arguments are forwarded to the individual printers.</p>","path":["Reports"],"tags":[]},{"location":"reports/#generating-examples","level":2,"title":"Generating Examples","text":"<p>To regenerate the example reports:</p> <pre><code>ruby docs/public/examples/generate_reports.rb\n</code></pre> <p>This profiles a small word-frequency workload and writes reports to <code>docs/public/examples/reports/</code>.</p>","path":["Reports"],"tags":[]}]}